<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Sanjay Pillay" />

<meta name="date" content="2019-11-21" />

<title>Talent Management Solution Case Study</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Sanjay Pillay!!</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">This Is Me</a>
</li>
<li>
  <a href="case_study1.html">Brewries A Case Study</a>
</li>
<li>
  <a href="case_study2.html">Talent Mgmt Case Study</a>
</li>
<li>
  <a href="groupproj.pdf">Stat MidTerm Proj</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sdpillay/dds_casestudy2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Talent Management Solution Case Study</h1>
<h4 class="author">Sanjay Pillay</h4>
<h4 class="date">11/21/2019</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The following code consists of the Exploratory Data Analysis conducted by DDSDataAnalytics for the Talent Manangement solution for Frito Lays. The Exploratory Data Analysis takes a look at key Attrition Trends and Factors leading to it. It also evaluates three models for classification of Employee Attrition prediction and uses the best to predict it, it also evaluates a linear regression based model for predicting salary.</p>
</div>
<div id="video-presentation" class="section level1">
<h1>Video Presentation</h1>
<p><a href="https://youtu.be/YyV7khyARWc" class="uri">https://youtu.be/YyV7khyARWc</a></p>
</div>
<div id="shinny-app" class="section level1">
<h1>Shinny App</h1>
<p><a href="https://dds-app1.shinyapps.io/shinny2/" class="uri">https://dds-app1.shinyapps.io/shinny2/</a></p>
</div>
<div id="githubio" class="section level1">
<h1>GitHubIo</h1>
<p><a href="https://sdpillay.github.io/" class="uri">https://sdpillay.github.io/</a></p>
</div>
<div id="github-repo" class="section level1">
<h1>GitHub repo</h1>
<p><a href="https://github.com/sdpillay/dds_casestudy2" class="uri">https://github.com/sdpillay/dds_casestudy2</a></p>
<div id="predicted-classification-income-file-location" class="section level2">
<h2>Predicted Classification &amp; Income file Location</h2>
<p>GitHubRepo../data/Case2PredictionsSanjayPillayAttrition.csv Predicted Attrition GitHubRepo../data/Case2PredictionsSanjayPillaySalary.csv Predicted Salary</p>
</div>
<div id="importing-libraries" class="section level2">
<h2>Importing Libraries</h2>
<pre class="r"><code>#uncomment below installpks command if running for the first time
#install.packages(&quot;dplyr&quot;, &quot;naniar&quot;,&quot;mice&quot;,&quot;VIM&quot;,&quot;stringi&quot;,&quot;stringr&quot;.&quot;rvest&quot;,&quot;purrr&quot;,&quot;tidyverse&quot;,&quot;tidyr&quot;,&quot;ggthemes&quot;,&quot;plotly&quot;,&quot;ggplot2&quot;,&quot;reshape2&quot;,&quot;GGally&quot;,&quot;caret&quot;,&quot;class&quot;,&quot;e1071&quot;,&quot;hexbin&quot;,&quot;car&quot;,&quot;scatterplot3d&quot;,&quot;randomForest&quot;,&quot;multcomp&quot;,&quot;broom&quot;)
library(dplyr) #join etc
library(plyr)
library(naniar) # check nulls
library(mice) # imputing
library(VIM) # view imputed datas
library(stringi)
library(stringr)
library(rvest) #html_table, html_node
library(purrr)
library(tidyverse) # Data cleaning
library(tidyr) # Data cleaning
library(ggthemes) #Plotting
library(plotly) #Plotting
library(ggplot2) #Plotting
library(reshape2) # melt
library(GGally) # ggpairs
library(caret) #Confution matrix
library(class)
library(caret)
library(e1071)
library(hexbin)
library(car)
library(scatterplot3d)
library(randomForest)
library(&quot;multcomp&quot;)
library(broom)</code></pre>
</div>
</div>
<div id="set-of-common-model-validation-methods" class="section level1">
<h1>Set of common model validation methods</h1>
<pre class="r"><code>#Lets add a binned column for Age, percenatage pay difference betweer employees pay vs the market monthly rate
fixData &lt;- function(data){
#for graphs
data = data %&gt;% mutate(deptx = factor(data$Department, levels = c(&quot;Research &amp; Development&quot;,&quot;Sales&quot;,&quot;Human Resources&quot;)))

data = data %&gt;% mutate(fjl = as.factor(JobLevel), 
                       fyc = as.factor(YearsAtCompany),
                       fycr = as.factor(YearsInCurrentRole), 
                       ftrg = as.factor(TrainingTimesLastYear),
                       fylp = as.factor(YearsSinceLastPromotion),
                                       bes = cut(EnvironmentSatisfaction, 
                                                 breaks=c(1,2,3,4,5), include.lowest=TRUE,  
                            right=FALSE,  labels=c( &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;)),
                       byc = cut(YearsAtCompany, 
                                                 breaks=c(0,3,6,10,15,30,40), include.lowest=TRUE,  
                            right=FALSE,  labels=c(  
                                        &quot;0-3&quot;,&quot;3-6&quot;,&quot;6-10&quot;,&quot;10-15&quot;,&quot;15-30&quot;,&quot;30-40&quot;)),
                            bwy = cut(TotalWorkingYears, 
                                                 breaks=c(0, 5, 10, 15, 20, 25, 30,40), include.lowest=TRUE,  
                            right=FALSE,  labels=c(&quot;0~5&quot;, &quot;5~10&quot;, 
                                        &quot;10~15&quot;,&quot;15~20&quot;,&quot;20~25&quot;,&quot;25~30&quot;,&quot;30~40&quot;)),
                            bdist = cut(DistanceFromHome, breaks=c(0, 5, 10, 15, 
                                20, 25,30), include.lowest=TRUE,  
                            right=FALSE,  labels=c(&quot;0~5&quot;, &quot;5~10&quot;, 
                                        &quot;10~15&quot;,&quot;15~20&quot;,&quot;20~25&quot;,&quot;25~30&quot;))
                            ,
                            bedu = cut(Education, 
                                                 breaks=c(1,2,3,4,5,6), include.lowest=TRUE,  
                            right=FALSE,  labels=c( &quot;1&quot;, 
                                        &quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
                            bwy = cut(TotalWorkingYears, 
                                                 breaks=c(0,5, 10, 15, 20, 25, 30,40), include.lowest=TRUE,  
                            right=FALSE,  labels=c(&quot;0~5&quot;, &quot;5~10&quot;, 
                                        &quot;10~15&quot;,&quot;15~20&quot;,&quot;20~25&quot;,&quot;25~30&quot;,&quot;30~40&quot;)),
                            bdist = cut(DistanceFromHome, breaks=c(0, 5, 10, 15, 
                                20, 25,30), include.lowest=TRUE,  
                            right=FALSE,  labels=c(&quot;0~5&quot;, &quot;5~10&quot;, 
                                        &quot;10~15&quot;,&quot;15~20&quot;,&quot;20~25&quot;,&quot;25~30&quot;))
                            ,
                            bage = cut(Age, breaks=c(18, 25, 30, 35, 
                                40, 45,50, 60), include.lowest=TRUE,  
                            right=FALSE,  labels=c(&quot;18~25&quot;, &quot;25~30&quot;, 
                                        &quot;30~35&quot;,&quot;35~40&quot;,&quot;40~45&quot;,&quot;45~50&quot;,&quot;50~60&quot;))
                            ,ppayd = (((MonthlyIncome - MonthlyRate)/MonthlyRate)*100),
                       bpayd = cut(ppayd, breaks=c(-100, -90 ,-80, -70, -60, -50, -40, -30, 
                            -20, -10, 0, 50, 100, 500, 2000), include.lowest=TRUE,  
                            right=FALSE,  labels=c(&quot;-90&quot;, &quot;-80&quot;,  &quot;-70&quot;, &quot;-60&quot;, &quot;-50&quot;, 
                                                   &quot;-40&quot;, &quot;-30&quot;,
                            &quot;-20&quot;,&quot;-10&quot;,&quot;0&quot;,&quot;50&quot;,&quot;100&quot;,&quot;500&quot;,&quot;2000&quot;)))
  return (data)
}

# Methods to get optimal k, check knn/NB accuracys
## Common Tunig k hyperparam function
# pass cv=1(split validation is default); 2(leave 1 out validation), numk to evaluate(default = 10), iteration to test(default = 20), data split percentage(default .75), data to tune on, explanatory names, dependant variable, plot (TRUE: print plot output)
tuneK &lt;- function(cv=0,numksF =10, numksT =20, iterations=20, splitPerc=.75, tuningData, cExplanotry, dependentVariable, plot = FALSE){
  masterAcc = 0
  ks = numksT-numksF
  PmasterAcc = matrix(nrow = iterations, ncol = ks)
  masterk = 0
  #splitPerc = .8
  result = 0
  oldA = .0
  
  for(j in 1:iterations)
  {

    trainInd = sample(1:dim(tuningData)[1],round(splitPerc * dim(tuningData)[1]))
    train = tuningData[trainInd,]
    test = tuningData[-trainInd,]
    #eval(substitute(dependentVariable), train)
    for(i in 1:ks)
    {
      
      if (cv==1){
        classifications = knn.cv(tuningData[,cExplanotry], 
                                 eval(substitute(dependentVariable), tuningData), 
                                 prob = TRUE, k=i+numksF)
        CM = confusionMatrix(table(classifications, eval(substitute(dependentVariable), 
                                                         tuningData) ))

      }else{
        classifications = knn(train[,cExplanotry],test[,cExplanotry], 
                            eval(substitute(dependentVariable), train),
                            prob = TRUE, k=i+numksF)
        CM = confusionMatrix(table(classifications,eval(substitute(dependentVariable), test)))
      }
      PmasterAcc[j,i] = CM$byClass[&quot;Specificity&quot;]
      if (CM$byClass[&quot;Specificity&quot;] &gt; oldA)
        {
          masterk = i
          masterAcc = CM$byClass[&quot;Specificity&quot;] #CM$overall[&quot;Accuracy&quot;]
          #print(masterk)
          # print(masterAcc)
          oldA = CM$byClass[&quot;Specificity&quot;] #CM$overall[&quot;Accuracy&quot;]
        }
      #CM$overall[1]
    }
    
  }
  MeanAcc = colMeans(PmasterAcc)
  result = which.max(MeanAcc)
  # add kfrom offset
  result = result + numksF
  #print(max(MeanAcc))
  if (plot){
    plot(seq(1 + numksF,ks + numksF,1),MeanAcc, type = &quot;l&quot;,main=&quot;Plot of Specificity vs k&quot;,
        xlab=&quot;k value&quot;,
        ylab=&quot;Specificity&quot;)
    
  }
  print(result)
  return(result)
}

#Method to get Random Forest Accuracy, use 20% of model for accuracy calculation
checkRandomForest &lt;- function(modelData, 
                               cformula){
  trainInd = sample(1:dim(modelData)[1],round(.8 * dim(modelData)[1]))
  testData = modelData[trainInd,]
  titanic_rf_v6 &lt;- randomForest(cformula,
                              data = modelData)
  titanic_rf_v6
  p = predict(titanic_rf_v6, newdata = testData)
  CM = confusionMatrix(table(p ,
                           testData$Attrition)) 
  print(CM)
  return (p)

 }

#Method to get Knn Accuracy
checkKnnAccuracy &lt;- function(k, iterations=20, modelData, 
                               cExplanotry, dependentVariable){
  accuracydf &lt;- data.frame(accuracy = numeric(iterations), 
                         sensitivity = numeric(iterations), specificity = numeric(iterations))
  masterAcc = matrix(nrow = iterations)
  for(j in 1:iterations)
  {
  
      classifications = knn.cv(modelData[,cExplanotry], 
                               eval(substitute(dependentVariable), modelData), 
                               prob = TRUE, k)
      CM = confusionMatrix(table(classifications, eval(substitute(dependentVariable), 
                                                       modelData) ))

      #masterAcc[j] = CM$overall[1]
      accuracydf$accuracy[j] = CM$overall[1]
      accuracydf$sensitivity[j] = CM$byClass[&quot;Sensitivity&quot;]
      accuracydf$specificity[j] = CM$byClass[&quot;Specificity&quot;]
      #print(CM)
 
  }
  #accuracydf[accuracydf$accuracy == 0.91,]
  summary_acc_df &lt;- accuracydf %&gt;% summarise(mean_accuracy = mean(accuracy), 
                mean_sensitivity = mean(sensitivity), mean_specificity = 
                  mean(specificity, na.rm = T))
  print(summary_acc_df)
 
}

#Method to get NB Accuracy using loocv , use 20% of model for accuracy calculation
checkNBAccuracy2 &lt;- function( modelData, 
                               formula){
  trainInd = sample(1:dim(modelData)[1],round(.8 * dim(modelData)[1]))
  testData = modelData[trainInd,]
 
  model &lt;- train(formula, method = &quot;nb&quot;, data = modelData, trControl = trainControl(method = &quot;cv&quot;))

 p = predict(model, newdata = testData)
  CM = confusionMatrix(table(p ,
                           testData$Attrition)) 
  print(CM)
  
}

#Method to get NB Accuracy 
checkNBAccuracy &lt;- function(iterations=20, splitPerc=.80, modelData, 
                               cExplanotry, dependentVariable){
  accuracydf &lt;- data.frame(accuracy = numeric(iterations), 
                         sensitivity = numeric(iterations), specificity = numeric(iterations))
  masterAcc = matrix(nrow = iterations)
  for(j in 1:iterations)
  {
      trainInd = sample(1:dim(modelData)[1],round(splitPerc * dim(modelData)[1]))
      train = modelData[trainInd,]
      test = modelData[-trainInd,]

      model = naiveBayes(train[,cExplanotry], eval(substitute(dependentVariable), train), laplace = 3)
      #table(predict(model,test[,c(1,2)]),test$Species)
      CM = confusionMatrix(table(predict(model, test[,cExplanotry] ),
                                 eval(substitute(dependentVariable), test) )) 
      accuracydf$accuracy[j] = CM$overall[1]
      accuracydf$sensitivity[j] = CM$byClass[&quot;Sensitivity&quot;]
      accuracydf$specificity[j] = CM$byClass[&quot;Specificity&quot;]
    }
  summary_acc_df &lt;- accuracydf %&gt;% summarise(mean_accuracy = mean(accuracy), 
                mean_sensitivity = mean(sensitivity), mean_specificity = 
                  mean(specificity, na.rm = T))
  print(summary_acc_df)
    # print(CM)
}</code></pre>
</div>
<div id="analysis" class="section level1">
<h1>Analysis</h1>
<pre class="r"><code>#Read supplied data
cdw = getwd()
employeeData1 = read.csv(paste(getwd(),&quot;/data/&quot;,&quot;CaseStudy2-data.csv&quot;, sep = &quot;&quot;),header = TRUE)
testEmpDataSal = read.csv(paste(getwd(),&quot;/data/&quot;,&quot;CaseStudy2CompSet No Salary.csv&quot;, sep = &quot;&quot;),header = TRUE)
testEmpDataAttr = read.csv(paste(getwd(),&quot;/data/&quot;,&quot;CaseStudy2CompSet No Attrition.csv&quot;, sep = &quot;&quot;),header = TRUE)

#Check structure
str(employeeData1)</code></pre>
<pre><code>## &#39;data.frame&#39;:    870 obs. of  36 variables:
##  $ ID                      : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Age                     : int  32 40 35 32 24 27 41 37 34 34 ...
##  $ Attrition               : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ BusinessTravel          : Factor w/ 3 levels &quot;Non-Travel&quot;,&quot;Travel_Frequently&quot;,..: 3 3 2 3 2 2 3 3 3 2 ...
##  $ DailyRate               : int  117 1308 200 801 567 294 1283 309 1333 653 ...
##  $ Department              : Factor w/ 3 levels &quot;Human Resources&quot;,..: 3 2 2 3 2 2 2 3 3 2 ...
##  $ DistanceFromHome        : int  13 14 18 1 2 10 5 10 10 10 ...
##  $ Education               : int  4 3 2 4 1 2 5 4 4 4 ...
##  $ EducationField          : Factor w/ 6 levels &quot;Human Resources&quot;,..: 2 4 2 3 6 2 4 2 2 6 ...
##  $ EmployeeCount           : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ EmployeeNumber          : int  859 1128 1412 2016 1646 733 1448 1105 1055 1597 ...
##  $ EnvironmentSatisfaction : int  2 3 3 3 1 4 2 4 3 4 ...
##  $ Gender                  : Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 2 2 2 1 1 2 2 1 1 2 ...
##  $ HourlyRate              : int  73 44 60 48 32 32 90 88 87 92 ...
##  $ JobInvolvement          : int  3 2 3 3 3 3 4 2 3 2 ...
##  $ JobLevel                : int  2 5 3 3 1 3 1 2 1 2 ...
##  $ JobRole                 : Factor w/ 9 levels &quot;Healthcare Representative&quot;,..: 8 6 5 8 7 5 7 8 9 1 ...
##  $ JobSatisfaction         : int  4 3 4 4 4 1 3 4 3 3 ...
##  $ MaritalStatus           : Factor w/ 3 levels &quot;Divorced&quot;,&quot;Married&quot;,..: 1 3 3 2 3 1 2 1 2 2 ...
##  $ MonthlyIncome           : int  4403 19626 9362 10422 3760 8793 2127 6694 2220 5063 ...
##  $ MonthlyRate             : int  9250 17544 19944 24032 17218 4809 5561 24223 18410 15332 ...
##  $ NumCompaniesWorked      : int  2 1 2 1 1 1 2 2 1 1 ...
##  $ Over18                  : Factor w/ 1 level &quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ OverTime                : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 2 1 2 2 2 1 ...
##  $ PercentSalaryHike       : int  11 14 11 19 13 21 12 14 19 14 ...
##  $ PerformanceRating       : int  3 3 3 3 3 4 3 3 3 3 ...
##  $ RelationshipSatisfaction: int  3 1 3 3 3 3 1 3 4 2 ...
##  $ StandardHours           : int  80 80 80 80 80 80 80 80 80 80 ...
##  $ StockOptionLevel        : int  1 0 0 2 0 2 0 3 1 1 ...
##  $ TotalWorkingYears       : int  8 21 10 14 6 9 7 8 1 8 ...
##  $ TrainingTimesLastYear   : int  3 2 2 3 2 4 5 5 2 3 ...
##  $ WorkLifeBalance         : int  2 4 3 3 3 2 2 3 3 2 ...
##  $ YearsAtCompany          : int  5 20 2 14 6 9 4 1 1 8 ...
##  $ YearsInCurrentRole      : int  2 7 2 10 3 7 2 0 1 2 ...
##  $ YearsSinceLastPromotion : int  0 4 2 5 1 1 0 0 0 7 ...
##  $ YearsWithCurrManager    : int  3 9 2 7 3 7 3 0 0 7 ...</code></pre>
<pre class="r"><code>#Check Income distribution
summary(employeeData1$MonthlyIncome)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1081    2840    4946    6390    8182   19999</code></pre>
<pre class="r"><code>#Fix data to add bins etc using common method
employeeData = fixData(employeeData1)

#Export for testing Shinny app
write_csv(employeeData, &quot;ShinnyData.csv&quot;,append = FALSE)

#Seperate Attrition vs non attrition
empL = employeeData %&gt;% filter(Attrition == &quot;Yes&quot;)
empW = employeeData %&gt;% filter(Attrition == &quot;No&quot;) 

#Trend Analysis
#Attritions based on Depatment
empL %&gt;% ggplot(aes(x=Department, fill=Attrition)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Attrition By Department&quot;, y = &quot;Employee Count&quot;, x=&quot;Department&quot; ) +geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;,
        vjust = -.25)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<pre class="r"><code>#Attritions based on Field
empL %&gt;% ggplot(aes(x=EducationField, fill=EducationField)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Attrition By Education Field&quot;, y = &quot;Employee Count&quot;, x=&quot;Eduction Field&quot; ) +geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;,
        vjust = -.25)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-2.png" width="768" /></p>
<pre class="r"><code>#Attritions based on Department / Field
empL %&gt;% ggplot(aes(x=EducationField, fill=deptx)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Attrition By Department/Education Field&quot;, y = &quot;Employee Count&quot;, x=&quot;Education Field&quot; ) +geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;,
        vjust = -.25)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-3.png" width="768" /></p>
<pre class="r"><code>#Attritions based on Education
empL %&gt;% ggplot(aes(x=bedu, fill=bedu)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Attrition By Education Years&quot;, y = &quot;Employee Count&quot;, x=&quot;Eduction Years&quot; , fill=&quot;Edu Yrs&quot;) +geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-4.png" width="768" /></p>
<pre class="r"><code>#Attritions based on Education / Department
empL = empL %&gt;% mutate(deptx = factor(empL$Department, levels = c(&quot;Research &amp; Development&quot;,&quot;Sales&quot;,&quot;Human Resources&quot;)))
empL %&gt;% ggplot(aes(x=bedu, fill=deptx)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Attrition By Education Years/Department&quot;, y = &quot;Employee Count&quot;, x=&quot;Eduction Years&quot; , fill=&quot;Department&quot;) + geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-5.png" width="768" /></p>
<pre class="r"><code>#Factor 1 Attrition due to Stock Options Overall Graphs
empL %&gt;% ggplot(aes(x=StockOptionLevel, fill=Attrition)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Stock Options Impact On Attrition&quot;, y = &quot;Employee Count&quot;, x=&quot;Stock Options&quot; ) + geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-6.png" width="768" /></p>
<pre class="r"><code>#Compare with existing employees
employeeData %&gt;% ggplot(mapping = aes(x = StockOptionLevel, fill = Attrition)) + geom_bar(position = &quot;dodge&quot;)+ labs(title=&quot;Comparing Options On Current/Former Employees&quot;, y = &quot;Employee Count&quot;, x=&quot;Stock Options&quot; ) + geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-7.png" width="768" /></p>
<pre class="r"><code>empL = empL %&gt;% mutate(deptx = factor(empL$Department, levels = c(&quot;Research &amp; Development&quot;,&quot;Sales&quot;,&quot;Human Resources&quot;)))

#1 Attrition due to Stock Options Dept Graphs
empL %&gt;% ggplot(aes(x=StockOptionLevel, fill=deptx)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Stock Options By Dept&quot;, y = &quot;Employee Count&quot;, x=&quot;Stock Options&quot;, fill=&quot;Department&quot;) +geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-8.png" width="768" /></p>
<pre class="r"><code>#Compare with existing employees
employeeData %&gt;% ggplot(mapping = aes(x = StockOptionLevel, y=, fill = Department)) + geom_bar(position = &quot;dodge&quot;)+ labs(title=&quot;Comparing Options On Current/Former Employees By Dept&quot;, y = &quot;Employee Count&quot;, x=&quot;Stock Options&quot; )+geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)+
    facet_wrap(~Attrition) </code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-9.png" width="768" /></p>
<pre class="r"><code>#1 Attrition due to Stock Options by Field Graphs
empL %&gt;% ggplot(aes(x=StockOptionLevel, fill=EducationField)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Stock Options By Education Field&quot;, y = &quot;Employee Count&quot;, x=&quot;Stock Options&quot; )</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-10.png" width="768" /></p>
<pre class="r"><code>#Compare with existing employees
employeeData %&gt;% ggplot(mapping = aes(x = StockOptionLevel,  fill = EducationField)) + geom_bar(position = &quot;dodge&quot;)+ labs(title=&quot;Comparing Options On Current/Former Employees By Field&quot;, y = &quot;Employee Count&quot;, x=&quot;Stock Options&quot; )+geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)+
    facet_wrap(~Attrition) </code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-11.png" width="768" /></p>
<pre class="r"><code>#Statistical significance Analyze mean difference for stock option for eductioan fields/Dept

#Prepare dataframes
emlLLS = empL %&gt;% filter(EducationField==&quot;Life Sciences&quot;)
emlWLS = empW %&gt;%  filter(EducationField==&quot;Life Sciences&quot;)

emlLR = empL %&gt;% filter(Department==&quot;Research &amp; Development&quot;)
emlWR = empW %&gt;%  filter(Department==&quot;Research &amp; Development&quot;)

#t.test for ovwe all difference in means of stock options offered Current/Former Emp
t.test(empW$StockOptionLevel,empL$StockOptionLevel)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  empW$StockOptionLevel and empL$StockOptionLevel
## t = 4.216, df = 187.92, p-value = 3.86e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.1845700 0.5091678
## sample estimates:
## mean of x mean of y 
## 0.8397260 0.4928571</code></pre>
<pre class="r"><code>#t.test for Life Science difference in means of stock options offered Current/Former Emp
t.test(emlWLS$StockOptionLevel,emlLLS$StockOptionLevel)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  emlWLS$StockOptionLevel and emlLLS$StockOptionLevel
## t = 2.9385, df = 69.667, p-value = 0.00447
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.1212505 0.6337139
## sample estimates:
## mean of x mean of y 
## 0.8491803 0.4716981</code></pre>
<pre class="r"><code>#t.test for R&amp;D difference in means of stock options offered Current/Former Emp
t.test(emlWR$StockOptionLevel,emlLR$StockOptionLevel)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  emlWR$StockOptionLevel and emlLR$StockOptionLevel
## t = 2.9809, df = 95.051, p-value = 0.00365
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.1109415 0.5533706
## sample estimates:
## mean of x mean of y 
## 0.8521561 0.5200000</code></pre>
<pre class="r"><code>#Factor 2 Investigate Income impact on attrition

#Plot income gap for employees left by department
empL %&gt;% filter(ppayd &lt; 100) %&gt;% ggplot(aes(x=ppayd, fill=Department)) +
  geom_histogram() +  labs(title=&quot;Pay Gap Distribution Per Deparment&quot;, y = &quot;Employee Count&quot;, x=&quot;Percent Pay Gap Against Monthly Rate&quot; )</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-12.png" width="768" /></p>
<pre class="r"><code>#Compare income gap with existing employees
employeeData %&gt;% filter(ppayd &lt; 100) %&gt;% ggplot(aes(x = bpayd, fill = Department)) + geom_bar(position = &quot;dodge&quot;)+ labs(title=&quot;Percent Pay Gap Against Monthly Rate By Dept&quot;, y = &quot;Employee Count&quot;, x=&quot;Pay Gap&quot; )+
    facet_wrap(~Attrition) </code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-13.png" width="768" /></p>
<pre class="r"><code>#Plot income gap for employees left by Field
empL %&gt;% filter(ppayd &lt; 100) %&gt;% ggplot(aes(x=ppayd, fill=EducationField)) +
  geom_histogram() +  labs(title=&quot;Pay Gap Distribution Per Field&quot;, y = &quot;Employee Count&quot;, x=&quot;Percent Pay Gap Against Monthly Rate&quot; )</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-14.png" width="768" /></p>
<pre class="r"><code>#Compare income gap with existing employees
employeeData %&gt;% filter(ppayd &lt; 100) %&gt;% ggplot(aes(x = bpayd, fill = EducationField)) + geom_bar(position = &quot;dodge&quot;)+ labs(title=&quot;Percent Pay Gap Against Monthly Rate By Field&quot;, y = &quot;Employee Count&quot;, x=&quot;Pay Gap&quot; )+
    facet_wrap(~Attrition) </code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-15.png" width="768" /></p>
<pre class="r"><code>#Compare income gap with existing employees
employeeData %&gt;% ggplot(mapping = aes(x = bpayd, fill = Attrition)) + geom_bar(position = &quot;dodge&quot;)+ labs(title=&quot;Comparing Options On Current/Former Employees&quot;, y = &quot;Employee Count&quot;, x=&quot;Stock Options&quot; ) + geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-16.png" width="768" /></p>
<pre class="r"><code>#Statistical significance Analyze mean difference for pay for eductioan fields/Dept
#t.test for three categories 

#Income gap mean difference for over all current and past employees
t.test(empW$ppayd,empL$ppayd)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  empW$ppayd and empL$ppayd
## t = 2.7151, df = 228.28, p-value = 0.007132
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   5.22860 32.89743
## sample estimates:
## mean of x mean of y 
## -31.17234 -50.23535</code></pre>
<pre class="r"><code>#Income gap mean difference for Life Science Field current and past employees
t.test(emlWLS$ppayd,emlLLS$ppayd)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  emlWLS$ppayd and emlLLS$ppayd
## t = 2.4079, df = 158.13, p-value = 0.0172
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   3.548078 35.932646
## sample estimates:
## mean of x mean of y 
## -31.69270 -51.43306</code></pre>
<pre class="r"><code>#Income gap mean difference for R&amp;D dept current and past employees
t.test(emlWR$ppayd,emlLR$ppayd)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  emlWR$ppayd and emlLR$ppayd
## t = 3.0773, df = 196.79, p-value = 0.002387
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   7.235556 33.057874
## sample estimates:
## mean of x mean of y 
## -35.66117 -55.80788</code></pre>
<pre class="r"><code># Attrition Factor #3
empL %&gt;% ggplot(aes(x=JobLevel, fill=bwy)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Level 1 Job / Total Working Years&quot;, y = &quot;Employee Count&quot;, x=&quot;Job Level&quot; , fill=&quot;Working Yrs&quot;) + geom_text(aes(label = scales::percent((..count..)/sum(..count..)) ), stat=&quot;count&quot;, vjust = -.25)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<pre><code>## Warning: position_stack requires non-overlapping x intervals</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-17.png" width="768" /></p>
<pre class="r"><code>empL %&gt;% ggplot(aes(x=JobLevel, fill=EducationField)) +
  geom_histogram(stat=&#39;count&#39;) + labs(title=&quot;Level 1 Job / Total Working Years&quot;, y = &quot;Employee Count&quot;, x=&quot;Job Level&quot; , fill=&quot;Fields&quot;) </code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-18.png" width="768" /></p>
<pre class="r"><code>#Classification Analysis
#Get the best k using cv
k = tuneK(cv=1,numksF =1, numksT =20, iterations=10, splitPerc=.80, employeeData,
          c(&#39;ppayd&#39;,&#39;EnvironmentSatisfaction&#39;, &#39;Age&#39;,&#39;WorkLifeBalance&#39;,
           &#39;JobInvolvement&#39;,&#39;JobLevel&#39;, &#39;JobSatisfaction&#39;,
           &#39;PercentSalaryHike&#39;,&#39;YearsAtCompany&#39;,&#39;JobInvolvement&#39;,
           &#39;YearsWithCurrManager&#39;, &#39;YearsSinceLastPromotion&#39;,  
           &#39;TotalWorkingYears&#39;, &#39;StockOptionLevel&#39;,&#39;TrainingTimesLastYear&#39;,
                                &#39;RelationshipSatisfaction&#39;, &#39;YearsInCurrentRole&#39;), Attrition, plot = TRUE)</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-3-19.png" width="768" /></p>
<pre><code>## [1] 2</code></pre>
<pre class="r"><code># Check Knn statistics
checkKnnAccuracy(1, 100, employeeData, 
                 c(&#39;ppayd&#39;,&#39;EnvironmentSatisfaction&#39;, &#39;Age&#39;,&#39;WorkLifeBalance&#39;,
                       &#39;JobInvolvement&#39;,&#39;JobLevel&#39;,
                   &#39;JobSatisfaction&#39;,&#39;PercentSalaryHike&#39;,&#39;YearsAtCompany&#39;,
                   &#39;JobInvolvement&#39;,&#39;YearsWithCurrManager&#39;,
                    &#39;YearsSinceLastPromotion&#39;,  &#39;TotalWorkingYears&#39;, 
                     &#39;StockOptionLevel&#39;,&#39;TrainingTimesLastYear&#39;,
                     &#39;RelationshipSatisfaction&#39;, &#39;YearsInCurrentRole&#39;),
                 Attrition)</code></pre>
<pre><code>##   mean_accuracy mean_sensitivity mean_specificity
## 1     0.7747126        0.8808219        0.2214286</code></pre>
<pre class="r"><code>#Chek NaievBayes Accuracy
checkNBAccuracy(100, 0.8, employeeData,  c(&#39;ppayd&#39;,&#39;EnvironmentSatisfaction&#39;,&#39;OverTime&#39;,
                          &#39;Age&#39;, &#39;WorkLifeBalance&#39;, &#39;JobInvolvement&#39;, &#39;JobLevel&#39;,
                              &#39;JobRole&#39;,&#39;JobSatisfaction&#39;,&#39;PercentSalaryHike&#39;,
                              &#39;YearsAtCompany&#39;,&#39;JobInvolvement&#39;, 
                                  &#39;YearsWithCurrManager&#39;,
                                  &#39;YearsSinceLastPromotion&#39;,  &#39;TotalWorkingYears&#39;, 
                                &#39;StockOptionLevel&#39;,
                                 &#39;YearsInCurrentRole&#39;), Attrition)</code></pre>
<pre><code>##   mean_accuracy mean_sensitivity mean_specificity
## 1     0.8171264        0.8686701        0.5426793</code></pre>
<pre class="r"><code>#Check Random Forestt Accuracy
p = checkRandomForest(employeeData, Attrition ~ ppayd+StockOptionLevel+TotalWorkingYears
                      +YearsAtCompany+JobLevel)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
## p      No Yes
##   No  587  25
##   Yes   4  80
##                                           
##                Accuracy : 0.9583          
##                  95% CI : (0.9407, 0.9719)
##     No Information Rate : 0.8491          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.8228          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0002041       
##                                           
##             Sensitivity : 0.9932          
##             Specificity : 0.7619          
##          Pos Pred Value : 0.9592          
##          Neg Pred Value : 0.9524          
##              Prevalence : 0.8491          
##          Detection Rate : 0.8434          
##    Detection Prevalence : 0.8793          
##       Balanced Accuracy : 0.8776          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="use-random-forest-to-classify-attrition-data" class="section level1">
<h1>Use Random Forest to classify Attrition data</h1>
<pre class="r"><code># Add requred columns to classify 
testEmpDataAttr = fixData(testEmpDataAttr)

#Build the Random forest model
model &lt;- randomForest(Attrition ~ ppayd+StockOptionLevel+TotalWorkingYears
                      +YearsAtCompany+JobLevel,
                              data = employeeData)
#Predict using test Data
p = predict(model, newdata = testEmpDataAttr)


#Export classified file
out = cbind.data.frame(ID = testEmpDataAttr$ID,Attrition=p, stringsAsFactors = TRUE)
write_csv(out, &quot;Case2PredictionsSanjayPillayAttrition.csv&quot;,append = FALSE)</code></pre>
</div>
<div id="model-to-predict-salary" class="section level1">
<h1>Model to predict Salary</h1>
<pre class="r"><code>#Plot corelation matrix for inspections of relationshipa
pairs(~MonthlyIncome+JobLevel+TotalWorkingYears+ JobRole 
      ,data=employeeData,
      main=&quot;Simple Scatterplot Matrix&quot;)</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<pre class="r"><code>#Investigate Corelation
cor.test(employeeData$MonthlyIncome, employeeData$JobLevel)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  employeeData$MonthlyIncome and employeeData$JobLevel
## t = 91.262, df = 868, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.9449434 0.9575400
## sample estimates:
##     cor 
## 0.95164</code></pre>
<pre class="r"><code>cor.test(employeeData$MonthlyIncome, employeeData$TotalWorkingYears)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  employeeData$MonthlyIncome and employeeData$TotalWorkingYears
## t = 36.544, df = 868, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7509003 0.8034053
## sample estimates:
##       cor 
## 0.7785112</code></pre>
<pre class="r"><code>#Lets investigate reidual plots for the model
fit2 = lm(MonthlyIncome~JobLevel+TotalWorkingYears +JobRole , data = employeeData)
par(mfrow = c(2, 2))
plot(fit2)</code></pre>
<p><img src="case_study2_files/figure-html/unnamed-chunk-5-2.png" width="768" /></p>
<pre class="r"><code>summary(fit2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ JobLevel + TotalWorkingYears + JobRole, 
##     data = employeeData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3989.9  -631.3    -9.4   616.8  4144.6 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   -103.243    203.291  -0.508  0.61168    
## JobLevel                      2795.329     81.784  34.179  &lt; 2e-16 ***
## TotalWorkingYears               47.998      7.951   6.037 2.34e-09 ***
## JobRoleHuman Resources        -321.962    251.744  -1.279  0.20127    
## JobRoleLaboratory Technician  -597.329    168.984  -3.535  0.00043 ***
## JobRoleManager                4002.415    228.696  17.501  &lt; 2e-16 ***
## JobRoleManufacturing Director  137.309    167.212   0.821  0.41178    
## JobRoleResearch Director      3993.674    214.342  18.632  &lt; 2e-16 ***
## JobRoleResearch Scientist     -324.522    169.387  -1.916  0.05572 .  
## JobRoleSales Executive         -66.048    144.221  -0.458  0.64709    
## JobRoleSales Representative   -410.303    211.660  -1.939  0.05289 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1063 on 859 degrees of freedom
## Multiple R-squared:  0.9472, Adjusted R-squared:  0.9466 
## F-statistic:  1541 on 10 and 859 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#Build the Linear model and validate using leave one out cross validations 
model = train(MonthlyIncome~JobLevel+TotalWorkingYears +JobRole, method = &quot;lm&quot;, data = employeeData, trControl = trainControl(method = &quot;LOOCV&quot;))

# RMSE for the model
model$results[&quot;RMSE&quot;]</code></pre>
<pre><code>##       RMSE
## 1 1068.603</code></pre>
<pre class="r"><code>#testEmpDataSal = fixData(testEmpDataSal)
#Predict the test dataset
p = predict(model, newdata = testEmpDataSal)
p = as.integer(p)
#Expor the predicted values
out= cbind.data.frame(ID=testEmpDataSal$ID, MonthlyIncome=p)
write_csv(out, &quot;Case2PredictionsSanjayPillaySalary.csv&quot;,append = FALSE)</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
